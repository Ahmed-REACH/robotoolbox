---
title: "Labelled Data for Form Languages"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Labelled Data for Form Languages}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  message = FALSE,
  warning = FALSE,
  echo = TRUE,
  comment = "#>"
)

```

`robotoolbox` allow you to access labels from languages in your form. It uses the [`labelled`](https://cran.r-project.org/web/packages/labelled/vignettes/intro_labelled.html) package to encode variable labels and value labels (choices).


```{r setup}
library(robotoolbox)
library(dplyr)
library(labelled)
```

Let's load data from the following project with three languages: English, French and Arabic.

### Survey questions

| type             | name      | label::English (en)  | label::Francais (fr)               | label::Arabic (ar) |
|:-----------------|:----------|:---------------------|:-----------------------------------|:-------------------|
| start            | start     |                      |                                    |                    |
| end              | end       |                      |                                    |                    |
| today            | today     |                      |                                    |                    |
| text             | full_name | What is your name?   | Quel est votre nom ?               | ما اسمك ؟          |
| select_one yesno | pet_yesno | Do you have any pet? | Avez-vous un animal de compagnie ? | هل تمتلك حيوانا أليفا ؟ |


### Choices

| list_name | name | label::English (en) | label::Francais (fr) | label::Arabic (ar) |
|:----------|-----:|:--------------------|:---------------------|:-------------------|
| yesno     |    1 | Yes                 | Oui                  | نعم                |
| yesno     |    0 | No                  | Non                  | لا                 |
|           |      |                     |                      |                    |


### Load the project asset

```{r set_asset}
uid <- "aYuTZn9vegi3Z49MXwKjep"
asset <- kobo_asset(uid)
asset
```

### List availables languages

```{r list_lang}
kobo_lang(asset)
```

### Read data in each languages

```{r load_data}
df_en <- kobo_data(asset, lang = "English (en)")
df_fr <- kobo_data(asset, lang = "Francais (fr)")
df_ar <- kobo_data(asset, lang = "Arabic (ar)")
glimpse(df_en)
```


### Access variable labels



```{r var_label1}
var_label(df_en$full_name)
var_label(df_fr$full_name)
var_label(df_ar$full_name)
```


```{r var_label2}
var_label(df_en$pet_yesno)
var_label(df_fr$pet_yesno)
var_label(df_ar$pet_yesno)
```

### Access `select_one` type question labels

```{r val_label}
table(to_factor(df_en$pet_yesno))
table(to_factor(df_fr$pet_yesno))
table(to_factor(df_ar$pet_yesno))
```
